## 一、用户端功能模块（模块级）
- 账号与认证模块（登录/注册/退出）  **[已完成]**
- 个人中心模块（用户信息/头像/密码）  **[已完成]**
- 图书浏览与搜索模块  **[已搭建待实现]**
- 图书推荐模块（KNN）  **[已搭建待实现]**
- 购物车模块  **[已搭建待实现]**
- 订单管理模块  **[已搭建待实现]**
- 收货地址模块  **[已搭建待实现]**
- 收藏模块  **[已搭建待实现]**
- 评价模块  **[已搭建待实现]**
- 浏览记录模块  **[已搭建待实现]**
# 购书推荐系统开发文档（基于 KNN 算法）

## 一、用户端功能模块（功能描述）
- 账号与认证模块：提供用户登录、注册、退出；登录成功后获取并保存 JWT，用于后续接口鉴权。  **[已完成]**
- 个人中心模块：展示并维护用户资料（昵称/邮箱/电话/头像），支持修改密码与头像更新。  **[已完成]**
- 图书浏览与搜索模块：支持图书分页浏览、分类筛选、关键词检索、查看图书详情。  **[已搭建待实现]**
- 图书推荐模块（KNN）：基于用户行为与相似用户的 KNN 计算，输出个性化推荐、相似图书与猜你喜欢等。  **[已搭建待实现]**
- 购物车模块：将图书加入购物车、修改数量、删除商品、清空购物车与统计购物车数量。  **[已搭建待实现]**
- 订单管理模块：创建订单、查看订单列表与详情、取消订单、支付订单、确认收货。  **[已搭建待实现]**
- 收货地址模块：维护收货地址增删改查与默认地址设置。  **[已搭建待实现]**
- 收藏模块：收藏/取消收藏图书，查看收藏列表与收藏状态。  **[已搭建待实现]**
- 评价模块：对已购图书进行评价，查看图书评价列表与我的评价。  **[已搭建待实现]**
- 浏览记录模块：记录并查看用户浏览历史，支持删除与清空。  **[已搭建待实现]**
> 论文题目：基于 KNN 算法的购书推荐系统设计与实现  
> 前端：Vue3（用户端 + 管理员端）  
> 后端：Java Spring Boot  
> 说明：本文件为整体开发文档与开发记录，包含功能模块、接口清单、页面规划，并标记已完成部分。

---

## 1. 项目概述
本系统面向图书电商场景，提供图书浏览、检索、收藏、购物车、下单、评价与推荐等核心功能，并在管理员端提供图书、分类、用户、订单与统计管理。推荐模块基于 KNN（K-Nearest Neighbors）算法，结合用户行为（浏览、收藏、评价、购买）进行个性化推荐。

---

## 2. 技术栈
- 前端：Vue3、Vite、Pinia、Vue-Router、Element Plus、Axios
- 后端：Spring Boot、MyBatis-Plus、JWT、Swagger/Knife4j、MySQL

---

## 2.5 项目总体结构（用户总结）
- 前端（Vue3 + Vite）
  - 用户端：登录/注册、图书浏览/搜索、购物车、订单管理、个人中心、推荐图书（KNN）
  - 管理员端：登录、图书管理、用户管理、订单管理、数据统计、推荐算法配置
- 后端（Spring Boot）分层：Controller / Service / Mapper / MySQL
- 对外接口：HTTP/REST API
- 关键算法：KNN 推荐算法模块

结构示意：
`
前端（用户端/管理员端） -> HTTP/REST API -> 后端（Controller/Service/Mapper） -> MySQL
                                   └-> KNN 推荐算法模块
`
## 二、用户认证（已完成）
### 2.1 功能范围
- 用户/管理员登录、注册、退出
- 用户名可用性检查
- 获取与维护当前用户信息（含头像与密码）
- 基于 JWT 的请求鉴权与角色权限控制

### 2.2 主要接口
| 功能 | 方法 | 路径 |
|---|---|---|
| 登录 | POST | /api/auth/login |
| 注册 | POST | /api/auth/register |
| 退出 | POST | /api/auth/logout |
| 检查用户名 | GET | /api/auth/check-username |
| 获取用户信息 | GET | /api/user/info |
| 更新用户信息 | PUT | /api/user/update |
| 修改密码 | PUT | /api/user/password |
| 更新头像 | PUT | /api/user/avatar |

### 2.3 鉴权流程（后端）
- 登录成功后生成 JWT（含 userId/username/role），前端保存并在请求头携带 Authorization: Bearer <token>
- 后端拦截 /api/** 路由，校验 Token 有效性并将用户信息写入上下文
- 公开接口（如图书列表/分类/部分推荐）在拦截器白名单中放行

### 2.4 权限控制（前后端协同）
- 角色：0=普通用户，1=管理员
- 前端路由守卫根据 role 控制访问用户端/管理员端页面
- 后端管理员接口通过角色校验拒绝非管理员访问
## 三、图书浏览（已完成）
### 3.1 功能范围
- 图书列表分页展示（支持分类筛选与关键词检索）
- 图书详情展示（含基础信息、库存、销量、评分等）
- 热门图书、新书推荐列表
- 浏览记录写入（用户查看详情时记录，服务实现待完善）

### 3.2 主要接口
| 功能 | 方法 | 路径 |
|---|---|---|
| 图书列表 | GET | /api/book/list |
| 图书详情 | GET | /api/book/detail/{id} |
| 搜索图书 | GET | /api/book/search |
| 热门图书 | GET | /api/book/hot |
| 新书推荐 | GET | /api/book/new |
## 2.6 数据库表结构（已建表）
- user：用户基础信息与角色/状态
- category：图书分类（支持父子层级）
- book：图书信息（价格/库存/销量/评分/状态）
- cart：购物车明细
- order：订单主表（订单号/金额/状态/收货信息）
- order_item：订单明细
- address：用户收货地址（含默认地址）
- review：图书评价（评分/评论）
- browse_history：浏览记录（KNN 行为特征）
- favorite：收藏记录（KNN 行为特征）
## 3. 功能模块规划（含完成度）

### 2.5 关键功能说明
- 注册：校验用户名是否已存在、邮箱是否唯一；密码与确认密码一致后保存（服务端加盐 MD5），默认角色为普通用户、状态为正常。
- 登录：校验用户名与密码；检查账号状态；生成 JWT 并返回用户基础信息（userId/username/nickname/avatar/role）。
- 退出：前端清理 token 与用户信息；后端接口仅返回成功（JWT 无状态）。
- 修改密码：校验原密码；新密码与确认密码一致后更新为加盐 MD5。
### 3.1 用户端功能
- 账号与认证
  - 登录/注册/退出  **[已完成]**
  - 用户名可用性检查  **[已完成]**
- 个人中心
  - 获取当前用户信息  **[已完成]**
  - 更新用户信息（昵称/邮箱/电话/头像）  **[已完成]**
  - 修改密码  **[已完成]**
- 图书与推荐
  - 图书列表/详情/搜索/热门/新书  **[已完成]**
  - 推荐：个性化/相似/猜你喜欢/热门/新书  **[已搭建待实现]**
- 购物流程
  - 购物车管理（增删改查/数量统计）  **[已搭建待实现]**
  - 收货地址管理（增删改查/默认地址）  **[已搭建待实现]**
  - 订单管理（创建/取消/支付/确认收货/列表/详情）  **[已搭建待实现]**
- 互动与记录
  - 图书评价（新增/删除/列表）  **[已搭建待实现]**
  - 收藏管理（收藏/取消/列表/检查）  **[已搭建待实现]**
  - 浏览记录（列表/删除/清空）  **[已搭建待实现]**

### 3.2 管理员端功能
- 管理员登录  **[已完成]**
- 用户管理
  - 用户列表/详情/启用禁用/重置密码/删除  **[已完成]**
- 图书管理（增删改查/上下架）  **[已完成-接口]**
- 分类管理（增删改查/树结构）  **[已完成-接口]**
- 订单管理（列表/详情/发货/状态变更/删除）  **[已搭建待实现]**
- 数据统计（总览/销量/排行/分类销量/用户增长）  **[已搭建待实现]**

### 3.3 公共与系统功能
- JWT 认证与拦截器  **[已完成]**
- 统一异常处理与响应结构  **[已完成]**
- CORS 跨域配置  **[已完成]**
- Swagger/Knife4j 接口文档  **[已完成]**
- 文件上传（头像/封面）  **[已搭建待实现]**

---

## 4. 接口文档（概要）

> 统一响应结构：
```json
{
  "code": 200,
  "message": "操作成功",
  "data": {}
}
```

### 4.1 认证与用户
| 功能 | 方法 | 路径 | 状态 |
|---|---|---|---|
| 用户登录 | POST | /api/auth/login | 已完成 |
| 用户注册 | POST | /api/auth/register | 已完成 |
| 退出登录 | POST | /api/auth/logout | 已完成 |
| 检查用户名 | GET | /api/auth/check-username | 已完成 |
| 获取当前用户信息 | GET | /api/user/info | 已完成 |
| 更新用户信息 | PUT | /api/user/update | 已完成 |
| 修改密码 | PUT | /api/user/password | 已完成 |
| 更新头像 | PUT | /api/user/avatar | 已完成 |

### 4.2 图书
| 功能 | 方法 | 路径 | 状态 |
|---|---|---|---|
| 图书列表（分页） | GET | /api/book/list | 已完成 |
| 图书详情 | GET | /api/book/detail/{id} | 已完成 |
| 搜索图书 | GET | /api/book/search | 已完成 |
| 热门图书 | GET | /api/book/hot | 已完成 |
| 新书推荐 | GET | /api/book/new | 已完成 |

### 4.3 分类
| 功能 | 方法 | 路径 | 状态 |
|---|---|---|---|
| 分类列表 | GET | /api/category/list | 已完成 |
| 分类树 | GET | /api/category/tree | 已完成 |

### 4.4 购物车
| 功能 | 方法 | 路径 | 状态 |
|---|---|---|---|
| 购物车列表 | GET | /api/cart/list | 已搭建待实现 |
| 加入购物车 | POST | /api/cart/add | 已搭建待实现 |
| 修改数量 | PUT | /api/cart/update | 已搭建待实现 |
| 删除商品 | DELETE | /api/cart/{id} | 已搭建待实现 |
| 清空购物车 | DELETE | /api/cart/clear | 已搭建待实现 |
| 购物车数量 | GET | /api/cart/count | 已搭建待实现 |

### 4.5 收货地址
| 功能 | 方法 | 路径 | 状态 |
|---|---|---|---|
| 地址列表 | GET | /api/address/list | 已搭建待实现 |
| 添加地址 | POST | /api/address/add | 已搭建待实现 |
| 更新地址 | PUT | /api/address/update | 已搭建待实现 |
| 删除地址 | DELETE | /api/address/{id} | 已搭建待实现 |
| 设置默认地址 | PUT | /api/address/default/{id} | 已搭建待实现 |

### 4.6 订单
| 功能 | 方法 | 路径 | 状态 |
|---|---|---|---|
| 创建订单 | POST | /api/order/create | 已搭建待实现 |
| 订单列表 | GET | /api/order/list | 已搭建待实现 |
| 订单详情 | GET | /api/order/detail/{id} | 已搭建待实现 |
| 取消订单 | PUT | /api/order/cancel/{id} | 已搭建待实现 |
| 支付订单 | PUT | /api/order/pay/{id} | 已搭建待实现 |
| 确认收货 | PUT | /api/order/confirm/{id} | 已搭建待实现 |

### 4.7 评价
| 功能 | 方法 | 路径 | 状态 |
|---|---|---|---|
| 添加评价 | POST | /api/review/add | 已搭建待实现 |
| 图书评价列表 | GET | /api/review/book/{bookId} | 已搭建待实现 |
| 我的评价 | GET | /api/review/my | 已搭建待实现 |
| 删除评价 | DELETE | /api/review/{id} | 已搭建待实现 |

### 4.8 收藏
| 功能 | 方法 | 路径 | 状态 |
|---|---|---|---|
| 添加收藏 | POST | /api/favorite/add/{bookId} | 已搭建待实现 |
| 取消收藏 | DELETE | /api/favorite/remove/{bookId} | 已搭建待实现 |
| 收藏列表 | GET | /api/favorite/list | 已搭建待实现 |
| 是否已收藏 | GET | /api/favorite/check/{bookId} | 已搭建待实现 |

### 4.9 浏览记录
| 功能 | 方法 | 路径 | 状态 |
|---|---|---|---|
| 浏览记录列表 | GET | /api/history/list | 已搭建待实现 |
| 清空浏览记录 | DELETE | /api/history/clear | 已搭建待实现 |
| 删除单条记录 | DELETE | /api/history/{id} | 已搭建待实现 |

### 4.10 文件上传
| 功能 | 方法 | 路径 | 状态 |
|---|---|---|---|
| 上传图片 | POST | /api/file/upload | 已搭建待实现 |
| 上传图书封面 | POST | /api/file/upload/cover | 已搭建待实现 |
| 上传用户头像 | POST | /api/file/upload/avatar | 已搭建待实现 |

### 4.11 推荐（KNN）
| 功能 | 方法 | 路径 | 状态 |
|---|---|---|---|
| 个性化推荐 | GET | /api/recommend/personal | 已搭建待实现 |
| 热门推荐 | GET | /api/recommend/hot | 已搭建待实现 |
| 相似图书 | GET | /api/recommend/similar/{bookId} | 已搭建待实现 |
| 猜你喜欢 | GET | /api/recommend/guess | 已搭建待实现 |
| 新书推荐 | GET | /api/recommend/new | 已搭建待实现 |

### 4.12 管理员端接口
| 功能 | 方法 | 路径 | 状态 |
|---|---|---|---|
| 用户列表 | GET | /api/admin/user/list | 已完成 |
| 用户详情 | GET | /api/admin/user/{id} | 已完成 |
| 更新用户状态 | PUT | /api/admin/user/status/{id} | 已完成 |
| 重置用户密码 | PUT | /api/admin/user/reset-password/{id} | 已完成 |
| 删除用户 | DELETE | /api/admin/user/{id} | 已完成 |
| 图书管理 | GET/POST/PUT/DELETE | /api/admin/book/** | 已完成-接口 |
| 分类管理 | GET/POST/PUT/DELETE | /api/admin/category/** | 已完成-接口 |
| 订单管理 | GET/PUT/DELETE | /api/admin/order/** | 已搭建待实现 |
| 数据统计 | GET | /api/admin/statistics/** | 已搭建待实现 |

---

## 5. 前端页面规划（含完成度）

### 5.1 用户端页面
- 用户登录页  **[已完成]**
- 用户注册页  **[已完成]**
- 用户首页（含顶部导航与入口卡片）  **[已完成-UI骨架]**
- 图书列表页  **[已完成]**
- 图书详情页  **[已完成]**
- 推荐页  **[未开始]**
- 购物车页  **[未开始]**
- 订单列表/详情页  **[未开始]**
- 个人中心/资料编辑页  **[已完成]**
- 收藏/评价/浏览记录页  **[未开始]**

### 5.2 管理员端页面
- 管理员登录页  **[已完成]**
- 管理员首页/控制台  **[已完成-UI骨架]**
- 图书管理页  **[已完成]**
- 分类管理页  **[已完成]**
- 用户管理页  **[已完成]**
- 订单管理页  **[未开始]**
- 数据统计页  **[未开始]**

---

## 6. 已完成内容位置（代码侧）
- 后端：认证与用户接口实现、管理员用户管理实现、JWT 鉴权与拦截、异常处理与统一响应（`Book_manger/src/main/java/com/bookmanager/**`）
- 前端：用户/管理员登录注册与路由守卫、Token 处理、基础首页 UI 骨架（`my-vue3-admin/src/**`）

---

## 7. 开发记录（简要）
- 2026-02-09：管理员端新增图书管理与分类管理页面，左侧菜单完成可点击联动
- 2026-02-09：完成图书与分类模块后端接口，新增图书列表与详情页面并完成前端联调
- 2026-02-09：整理数据库表结构并补充到开发文档
- 2026-02-09：新增个人中心页面与管理员用户管理页面，完成认证相关接口前端联调
- 2024-2026：完成用户登录/注册/权限拦截/管理员用户管理等核心认证链路
- 后续：补齐图书、订单、购物车、推荐等核心业务；完善前后端对接与页面

---

## 8. 下一步开发建议
1. 优先补齐“图书管理 + 图书列表/详情”接口与前端页面（形成可浏览闭环）
2. 再实现“购物车 + 订单 + 地址”形成交易闭环
3. 最后接入“评价 + 收藏 + 浏览记录 + KNN 推荐”形成推荐闭环

---

> 本文档用于毕业论文系统设计与实现记录，后续可持续补充数据表设计、KNN 推荐计算流程与评估指标。







## 四、用户端功能（详细描述）
- 图书列表/分类筛选/关键词搜索/图书详情：支持分页浏览、按分类筛选、关键词检索与详情展示。**[已完成]**
- 购物车：添加购物车、修改数量、删除商品、清空购物车。**[已搭建待实现]**
- 订单管理：创建订单、订单列表、订单详情、取消订单。**[已搭建待实现]**
- 个人中心：个人信息修改、收货地址管理、购买历史。**[已搭建待实现]**
- 图书推荐：基于 KNN 的个性化推荐、热门推荐。**[已搭建待实现]**
- 图书评价：评分、评论、查看评论。**[已搭建待实现]**

## 五、管理员端功能模块（模块与描述）
- 管理员认证：登录、退出。**[已完成-登录]**
- 图书管理：图书 CRUD、库存管理。**[已完成-接口]**（批量导入未实现）
- 分类管理：图书分类的增删改查。**[已完成-接口]**
- 用户管理：用户列表、禁用/启用用户。**[已完成-基础用户管理]**
- 订单管理：订单列表、发货、订单状态修改。**[已搭建待实现]**
- 数据统计：销售统计、用户统计、图书销量排行。**[已搭建待实现]**
- 推荐配置：KNN 算法参数配置。**[已搭建待实现]**

## 六、KNN 推荐算法模块
### 6.1 用户特征向量构建
- 购买历史（书籍类别偏好）
- 浏览记录
- 评分记录
- 收藏记录

### 6.2 图书特征向量构建
- 分类
- 价格区间
- 评分
- 销量

### 6.3 KNN 计算流程
1. 提取当前用户的特征向量
2. 计算与其他用户的相似度（欧氏距离/余弦相似度）
3. 找出 K 个最相似的用户
4. 获取这 K 个用户购买过但当前用户未购买的图书
5. 按推荐权重排序输出



